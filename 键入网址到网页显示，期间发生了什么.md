# HTTP
> HTTP哪里来的？


浏览器的第一步工作就是解析URL，然后生成HTTP调用服务器。
> URL的组成

协议//web服务器/目录/文件。
见下图：

![URL 解析](https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E9%94%AE%E5%85%A5%E7%BD%91%E5%9D%80%E8%BF%87%E7%A8%8B/3.jpg)
其中蓝色部分可以省略，省略了之后就是访问默认浏览器比如，index.html。
对URL解析完成之后就已经确定了服务器以及文件名，接下来就是根据这些信息生成HTTP消息了。
# DNS
DNS的作用可以理解为一个备忘录，对于服务器来说，他的ip不好记忆，所以就有了域名，比如baidu.com。
那么现在的问题就是服务器是怎么讲baidu.com和ip建立联系的呢，就是通过`备忘录`也就是DNS，DNS会告诉服务器如何通过baidu.com拿到对应IP。
> DNS是如何通过域名就能拿到对应的IP的

DNS也分层级
- 根 DNS 服务器（.）
- 顶级域 DNS 服务器（.com）
- 权威 DNS 服务器（server.com）
也就是说越靠右层级越高，并且有个隐藏层级baidu.com.。这里最右边的点就是根域

1. 当客户端发起一个DNS请求问DNS服务器www.baidu.com的IP是多少。
2. 如果有缓存，比如说浏览器缓存，操作系统缓存等就直接返回缓存里的ip，如果没有缓存就问本地DNS服务器。
3. 本地DNS服务器回去问根域服务器，根域服务器告诉你他属于com下面，你去问问顶级域服务器吧。
4. 随后拿到com去询问顶级域服务器www.baidu.com 的 IP 地址，顶级域服务器告诉你他在baidu.com权威DNS服务器下面你去问他吧。
5. 于是本地DNS去询问权威域服务器，权威域服务器返回对应的IP。
6. 本地DNS将ip返回给客户端，客户端与目标建立连接。
至此，我们完成了 DNS 的解析过程。现在总结一下，整个过程我画成了一个图。

![域名解析的工作流程](https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E9%94%AE%E5%85%A5%E7%BD%91%E5%9D%80%E8%BF%87%E7%A8%8B/6.jpg)

DNS 域名解析的过程蛮有意思的，整个过程就和我们日常生活中找人问路的过程类似，**只指路不带路**。

> 是不是每次拿到ip都要这么麻烦呢？

当然不是了，还有缓存这个东西。
首先看浏览器有没有缓存。
然后是操作系统。
然后是hosts文件。
最后才是让本地DNS去获取ip并加入缓存。
# 协议线
协议线包含TCP、UDP还有IP，协议线的作用就是告诉你该用TCP还UDP，然后是使用IP里的ICMP还是ARP。
简单来说就是一个指南针，告诉你该往哪个方向走。
# TCP
tcp的组成有几个重要的部分：
1. **`序号`**：用来解决包乱序问题
2. 确认号：用来确认发出去对方是否有收到，解决丢包问题
3. 状态：用来判断TCP的链接状态
4. 窗口大小：用来做流量控制。
5. TCP还会做**拥塞控制**。

> 三次握手

其次TCP还会在传输数据之前，先进行三次握手，其目的是为了确保双方都能发送和接收数据。
> TCP分隔数据

当HTTP数据过大的时候超过MSS会把数据分为多个TCP段，进行多次发送，这样做的目的是为了防止发送失败全部数据重试，分多次的话可以保证某部分失败只重试某部分就够了。
现在建立了TCP连接，需要通过IP来进行寻址然后传输数据。
# IP
[[随记（计网）#网络层]]
# MAC
[[随记（计网）#网络接口层]]
# 网卡
现在数据包都有了，数据包在内存中只是一串二进制是没法进行传输的，传输需要通过网卡使用网卡驱动程序将二进制转化为电信号通过网线发送出去。