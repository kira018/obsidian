HTTP 由于是明文传输，所以安全上存在以下三个风险：

- **窃听风险**，比如通信链路上可以获取通信内容，用户号容易没。
- **篡改风险**，比如强制植入垃圾广告，视觉污染，用户眼容易瞎。
- **冒充风险**，比如冒充淘宝网站，用户钱容易没。

HTTP**S** 在 HTTP 与 TCP 层之间加入了 `SSL/TLS` 协议，可以很好的解决了上述的风险：

- **信息加密**：交互信息无法被窃取，但你的号会因为「自身忘记」账号而没。
- **校验机制**：无法篡改通信内容，篡改了就不能正常显示，但百度「竞价排名」依然可以搜索垃圾广告。
- **身份证书**：证明淘宝是真的淘宝网，但你的钱还是会因为「剁手」而没。

可见，只要自身不做「恶」，SSL/TLS 协议是能保证通信是安全的。

> HTTPS 是如何解决上面的三个风险的？

- **混合加密**的方式实现信息的**机密性**，解决了窃听的风险。
- **摘要算法**的方式来实现**完整性**，它能够为数据生成独一无二的「指纹」，指纹用于校验数据的完整性，解决了篡改的风险。
- 将服务器公钥放入到**数字证书**中，解决了冒充的风险。

_1. 混合加密_

通过**混合加密**的方式可以保证信息的**机密性**，解决了窃听的风险。

![混合加密](https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/HTTP/20-%E6%B7%B7%E5%90%88%E5%8A%A0%E5%AF%86.png)

HTTPS 采用的是**对称加密**和**非对称加密**结合的「混合加密」方式：

- 在通信建立前采用**非对称加密**的方式交换「会话秘钥」，后续就不再使用非对称加密。
- 在通信过程中全部使用**对称加密**的「会话秘钥」的方式加密明文数据。

采用「混合加密」的方式的原因：

- **对称加密**只使用一个密钥，运算速度快，密钥必须保密，无法做到安全的密钥交换。
- **非对称加密**使用两个密钥：公钥和私钥，公钥可以任意分发而私钥保密，解决了密钥交换问题但速度慢。
_2. 摘要算法 + 数字签名_

摘要算法的作用是为了保证内容不被篡改，简单来说我给你发送一个数据，中间被人修改了然后发给服务器，服务器并不知道被篡改过了会继续展示数据或者添加数据。
为了避免这个问题就有了摘要算法。
所以摘要算法是为了避免内容被篡改。
> 摘要算法是怎么能做到避免被篡改的呢？

简单举个例子，在发送给服务器之前我会对内容进行加密得到一个hash值，然后将hash值和内容一起发送过去，服务器接收到之后会对内容进行加密然后比对俩个hash值，如果一样就说明没有被篡改。
但是这个也不能完全避免安全问题，假如说攻击者同时替换内容+hash值，服务器接受的时候加密内容得到的hash值跟攻击者的自然一样，这种情况依旧会导致安全问题。这个时候数字签名就派上用处了。
> 数字签名是怎么解决内容+hash都被替换的问题的？

非对称加密解决的。
非对称加密主要有俩个流程：
公钥加密私钥解密：这个一般用来保证数据安全
私钥加密公钥解密：这个一般用来做身份认证
https使用的是第二种方式，并且是对hash值进行私钥加密，而不是内容，因为一般来说加密会有性能得考虑，所以对hash值加密就行了。
流程：
- 客户端对hash值私钥加密，然后把内容+数字签名（加密后的hash）一起发送给服务器，服务器接收到之后对内容hash在对数字签名解密得到hash然后比对，然后就能保证内容没被篡改
- 比如篡改者修改修改内容和hash值，但是由于他没有私钥，所以客户端解密的时候一定会失败。

_3. 数字证书_

前面我们知道：

- 可以通过哈希算法来保证消息的完整性；
- 可以通过数字签名来保证消息的来源可靠性（能确认消息是由持有私钥的一方发送的）；

还有一个问题，自己伪造出一对公私钥。这样依然会有问题。
所以这时候就有CA机构了，服务器只需要把公钥注册到CA机构，CA机构会把你的公钥打包成一个数字证书，CA这里用私钥进行加密得到数字签名，这个数字证书包含【公钥+数字签名+个人信息】
后续的流程：
- 如果攻击者伪造一个公钥之后服务器会拿这个公钥去CA里进行验证，CA使用你的公钥解密，然后得到的东西对比CA看看有没有注册过，有注册过说明是安全的，如果CA解密出来的东西不存在说明有问题。


